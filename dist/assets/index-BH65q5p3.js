var d=(e,i,s)=>new Promise((p,u)=>{var f=o=>{try{n(s.next(o))}catch(m){u(m)}},h=o=>{try{n(s.throw(o))}catch(m){u(m)}},n=o=>o.done?p(o.value):Promise.resolve(o.value).then(f,h);n((s=s.apply(e,i)).next())});import{i as O}from"./index-D46PiUjU.js";import{B as N,u as $}from"./useTable-DUDBe34E.js";import{T as A,_ as E,a as q}from"./useForm-DGqLGoed.js";import{b as U,aq as V,v as G,_ as H}from"./entry/index-DvPJ5Vzs-1718250502895.js";import{u as W}from"./index-BsqrLki-.js";import{S as j,g as z,c as J,s as K,d as _}from"./SmsProviderDrawer-Q6E_kC_1.js";import Q from"./LogModal-DGZbpOzL.js";import{B as X,b as Y}from"./index-3BhCtvAk.js";import{a as Z}from"./messageSender-RcmoMCS5.js";import{M as x}from"./antd-BPAr-OsJ.js";import{d as ee,f as k,k as l,ab as r,_ as B,$ as oe,a8 as c,a7 as D,G as M,a1 as y,aa as I}from"./vue-BMCEF3Jf.js";import"./ExclamationCircleOutlined-s2Xy4hHc.js";import"./index-CU9epjG0.js";import"./isBoolean-Dou3jA6I.js";import"./isNumber-j3SIk7av.js";import"./index-Bji4O60f.js";import"./object-BY_VTB7H.js";import"./isDeepEqual-DDA9_BTC.js";import"./useWindowSizeFn-DLNrSaDV.js";import"./onMountedOrActivated-CPthIpwg.js";import"./sortable.esm-DFFrMEeC.js";import"./index-CBIPPzDl.js";import"./copyTextToClipboard-sKBLHCHY.js";import"./useSortable-DDWVM7pI.js";import"./index-DQkEJ5Ra.js";import"./index-DsLJPeYo.js";import"./components-CoxIuU15.js";const{t:a}=U(),ne=[{field:"phoneNumber",label:a("mcms.sms.phoneNumber"),component:"Input",required:!0},{field:"params",label:a("mcms.sms.params"),component:"Input",required:!0,helpMessage(e){return a("mcms.sms.paramsHelp")}},{field:"templateId",label:a("mcms.sms.templateId"),component:"Input",helpMessage(e){return a("mcms.sms.templateIdHelp")}},{field:"signName",label:a("mcms.sms.signName"),component:"Input"},{field:"provider",label:a("mcms.emailLog.provider"),component:"Select",componentProps:{options:[{label:a("mcms.smsProvider.tencent"),value:"tencent"},{label:a("mcms.smsProvider.aliyun"),value:"aliyun"},{label:a("mcms.smsProvider.uni"),value:"uni"}]}}],te=ee({name:"SmsProviderManagement",components:{BasicTable:N,SmsProviderDrawer:j,TableAction:A,Button:V,LogModal:Q,BasicModal:X,BasicForm:E},setup(){const{t:e}=G.useI18n(),i=k(),s=k(!1),p=k(!1),[u,{openDrawer:f}]=W(),[h,{reload:n}]=$({title:e("mcms.smsProvider.smsProviderList"),api:z,columns:J,formConfig:{labelWidth:120,schemas:K},useSearchForm:!0,showTableSetting:!0,bordered:!0,showIndexColumn:!1,clickToRowSelect:!1,actionColumn:{width:30,title:e("common.action"),dataIndex:"action",fixed:void 0},rowKey:"id",rowSelection:{type:"checkbox",onChange:(t,P)=>{i.value=t,s.value=t.length>0}}}),[o,{openModal:m}]=Y(),[v,{validate:S}]=q({labelWidth:160,labelAlign:"right",baseColProps:{span:18},layout:"vertical",schemas:ne,showActionButtonGroup:!1});function w(t){m(!0,{record:t})}function C(){f(!0,{isUpdate:!1})}function b(t){f(!0,{record:t,isUpdate:!0})}function g(t){return d(this,null,function*(){(yield _({ids:[t.id]})).code===0&&(yield n())})}function T(){return d(this,null,function*(){x.confirm({title:e("common.deleteConfirm"),icon:l(O.ExclamationCircleOutlined),onOk(){return d(this,null,function*(){(yield _({ids:i.value})).code===0&&(s.value=!1,yield n())})},onCancel(){}})})}function F(){return d(this,null,function*(){yield n()})}function L(){p.value=!0}function R(){return d(this,null,function*(){const t=yield S();yield Z(t)})}return{t:e,registerTable:h,registerDrawer:u,handleCreate:C,handleEdit:b,handleDelete:g,handleSuccess:F,handleBatchDelete:T,showDeleteButton:s,registerModal:o,handleOpenLogModal:w,showSenderModal:p,handleOpenSenderModal:L,registerForm:v,handleSendSms:R}}});function ae(e,i,s,p,u,f){const h=r("Button"),n=r("a-button"),o=r("TableAction"),m=r("BasicTable"),v=r("SmsProviderDrawer"),S=r("LogModal"),w=r("BasicForm"),C=r("BasicModal");return B(),oe("div",null,[l(m,{onRegister:e.registerTable},{tableTitle:c(()=>[e.showDeleteButton?(B(),D(h,{key:0,type:"primary",danger:"",preIcon:"ant-design:delete-outlined",onClick:e.handleBatchDelete},{default:c(()=>[M(y(e.t("common.delete")),1)]),_:1},8,["onClick"])):I("",!0)]),toolbar:c(()=>[l(n,{type:"success",onClick:e.handleOpenSenderModal},{default:c(()=>[M(y(e.t("mcms.sms.sendSms")),1)]),_:1},8,["onClick"]),l(n,{type:"primary",onClick:e.handleCreate},{default:c(()=>[M(y(e.t("mcms.smsProvider.addSmsProvider")),1)]),_:1},8,["onClick"])]),bodyCell:c(({column:b,record:g})=>[b.key==="action"?(B(),D(o,{key:0,actions:[{icon:"clarity:note-edit-line",onClick:e.handleEdit.bind(null,g)},{icon:"ic:round-library-books",tooltip:e.t("common.viewLog"),onClick:e.handleOpenLogModal.bind(null,g)},{icon:"ant-design:delete-outlined",color:"error",popConfirm:{title:e.t("common.deleteConfirm"),placement:"left",confirm:e.handleDelete.bind(null,g)}}]},null,8,["actions"])):I("",!0)]),_:1},8,["onRegister"]),l(v,{onRegister:e.registerDrawer,onSuccess:e.handleSuccess},null,8,["onRegister","onSuccess"]),l(S,{onRegister:e.registerModal,defaultFullscreen:!0},null,8,["onRegister"]),l(C,{open:e.showSenderModal,"onUpdate:open":i[0]||(i[0]=b=>e.showSenderModal=b),title:e.t("mcms.sms.sendSms"),onOk:e.handleSendSms},{default:c(()=>[l(w,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},8,["open","title","onOk"])])}const Re=H(te,[["render",ae]]);export{Re as default};
