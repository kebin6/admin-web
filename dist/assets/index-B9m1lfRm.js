var c=(e,l,o)=>new Promise((p,s)=>{var u=t=>{try{i(o.next(t))}catch(r){s(r)}},a=t=>{try{i(o.throw(t))}catch(r){s(r)}},i=t=>t.done?p(t.value):Promise.resolve(t.value).then(u,a);i((o=o.apply(e,l)).next())});import{i as T}from"./index-DnIErCUr.js";import{B as A,u as S}from"./useTable-DprHC9Xn.js";import{T as v}from"./useForm-Cq3McrEd.js";import{aq as I,v as R,_ as $}from"./entry/index-DaEB-Y-8-1718870402071.js";import{u as E}from"./index-CL7BM-aX.js";import{A as M,g as N,c as V,s as F,d as g}from"./ApiDrawer-p5-ev2zg.js";import{M as L}from"./antd-BNMfrwLX.js";import{d as O,f as y,k as f,ab as m,_ as w,$ as U,a8 as d,a7 as k,G as _,a1 as B,aa as D}from"./vue-BMCEF3Jf.js";import"./ExclamationCircleOutlined-BOht0FRf.js";import"./index-DxzXX1s5.js";import"./isBoolean-Dou3jA6I.js";import"./index-CmerSBcF.js";import"./useWindowSizeFn-NWtUJjFU.js";import"./isDeepEqual-BYVIA4i9.js";import"./isNumber-j3SIk7av.js";import"./index-BQ8_-9UH.js";import"./object-BY_VTB7H.js";import"./onMountedOrActivated-CPthIpwg.js";import"./sortable.esm-DFFrMEeC.js";import"./index-BgDhUzJz.js";import"./copyTextToClipboard-Ke6QqFB6.js";import"./useSortable-nsvvptnY.js";import"./index-BdOZjJKO.js";import"./index-D-g43U_h.js";const j=O({name:"ApiManagement",components:{BasicTable:A,ApiDrawer:M,TableAction:v,Button:I},setup(){const{t:e}=R.useI18n(),l=y(),o=y(!1),[p,{openDrawer:s}]=E(),[u,{reload:a}]=S({title:e("sys.apis.apiList"),api:N,columns:V,formConfig:{labelWidth:120,schemas:F},useSearchForm:!0,showTableSetting:!0,bordered:!0,showIndexColumn:!1,clickToRowSelect:!1,actionColumn:{width:30,title:e("common.action"),dataIndex:"action",fixed:void 0},rowKey:"id",rowSelection:{type:"checkbox",onChange:(n,C)=>{l.value=n,o.value=n.length>0}}});function i(){s(!0,{isUpdate:!1})}function t(n){s(!0,{record:n,isUpdate:!0})}function r(n){return c(this,null,function*(){(yield g({ids:[n.id]})).code===0&&(yield a())})}function h(){return c(this,null,function*(){L.confirm({title:e("common.deleteConfirm"),icon:f(T.ExclamationCircleOutlined),onOk(){return c(this,null,function*(){(yield g({ids:l.value})).code===0&&(o.value=!1,yield a())})},onCancel(){}})})}function b(){return c(this,null,function*(){yield a()})}return{t:e,registerTable:u,registerDrawer:p,handleCreate:i,handleEdit:t,handleDelete:r,handleSuccess:b,handleBatchDelete:h,showDeleteButton:o}}});function q(e,l,o,p,s,u){const a=m("Button"),i=m("a-button"),t=m("TableAction"),r=m("BasicTable"),h=m("ApiDrawer");return w(),U("div",null,[f(r,{onRegister:e.registerTable},{tableTitle:d(()=>[e.showDeleteButton?(w(),k(a,{key:0,type:"primary",danger:"",preIcon:"ant-design:delete-outlined",onClick:e.handleBatchDelete},{default:d(()=>[_(B(e.t("common.delete")),1)]),_:1},8,["onClick"])):D("",!0)]),toolbar:d(()=>[f(i,{type:"primary",onClick:e.handleCreate},{default:d(()=>[_(B(e.t("sys.apis.addApi")),1)]),_:1},8,["onClick"])]),bodyCell:d(({column:b,record:n})=>[b.key==="action"?(w(),k(t,{key:0,actions:[{icon:"clarity:note-edit-line",onClick:e.handleEdit.bind(null,n)},{icon:"ant-design:delete-outlined",color:"error",popConfirm:{title:e.t("common.deleteConfirm"),placement:"left",confirm:e.handleDelete.bind(null,n)}}]},null,8,["actions"])):D("",!0)]),_:1},8,["onRegister"]),f(h,{onRegister:e.registerDrawer,onSuccess:e.handleSuccess},null,8,["onRegister","onSuccess"])])}const ue=$(j,[["render",q]]);export{ue as default};
