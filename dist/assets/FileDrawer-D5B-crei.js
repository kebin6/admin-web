var v=Object.defineProperty;var d=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable;var g=(e,s,t)=>s in e?v(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,h=(e,s)=>{for(var t in s||(s={}))I.call(s,t)&&g(e,t,s[t]);if(d)for(var t of d(s))y.call(s,t)&&g(e,t,s[t]);return e};var c=(e,s,t)=>new Promise((l,m)=>{var p=i=>{try{o(t.next(i))}catch(n){m(n)}},u=i=>{try{o(t.throw(i))}catch(n){m(n)}},o=i=>i.done?l(i.value):Promise.resolve(i.value).then(p,u);o((t=t.apply(e,s)).next())});import{_ as T,a as B}from"./useForm-5wnZKxWU.js";import{a as f,b as D,as as P,v as z,_ as R}from"./entry/index-C41ZFr6n-1718602026943.js";import{g as b}from"./fileTag-B4o9ZOqJ.js";import{l as k,d as x,f as C,c as $,u as F,ab as w,_ as A,a7 as L,a8 as N,k as O,ac as V}from"./vue-BMCEF3Jf.js";import{Q as j}from"./antd-BPAr-OsJ.js";import{B as U,a as G}from"./index-DDf_l8hU.js";function ae(e,s){return f.uploadFile({url:"/fms-api/upload",onUploadProgress:s},e)}const ie=(e,s="notice")=>f.post({url:"/fms-api/file/list",params:e},{errorMessageMode:s,successMessageMode:"none"}),q=(e,s="notice")=>f.post({url:"/fms-api/file/update",params:e},{errorMessageMode:s,successMessageMode:s}),le=(e,s="notice")=>f.post({url:"/fms-api/file/delete",params:e},{errorMessageMode:s,successMessageMode:s}),H=(e,s,t="notice")=>f.post({url:"/fms-api/file/status",params:{id:e,status:s}},{errorMessageMode:t,successMessageMode:t}),oe=(e,s="none")=>f.get({url:"/fms-api/file/download/"+e,responseType:"blob"},{errorMessageMode:s}),{t:a}=D(),ne=[{title:a("fms.file.fileName"),dataIndex:"name",width:50},{title:a("fms.file.fileType"),dataIndex:"fileType",width:20,customRender:({record:e})=>e.fileType==="video"?a("fms.file.video"):e.fileType==="audio"?a("fms.file.audio"):e.fileType==="image"?a("fms.file.image"):a("fms.file.other")},{title:a("common.status"),dataIndex:"status",width:20,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),k(j,{checked:e.status===1,checkedChildren:a("fms.file.public"),unCheckedChildren:a("fms.file.private"),loading:e.pendingStatus,onChange(s,t){e.pendingStatus=!0;const l=s?1:0;H(e.id,l).then(()=>{e.status=l}).finally(()=>{e.pendingStatus=!1})}}))},{title:a("fms.file.filePath"),dataIndex:"path",width:40},{title:a("fms.file.fileSize"),dataIndex:"size",width:20,customRender:({record:e})=>e.size>1073741824?(e.size/1073741824).toFixed(2)+"GB":e.size>1048576?(e.size/1048576).toFixed(2)+"MB":(e.size/1024).toFixed(2)+"KB"},{title:a("common.createTime"),dataIndex:"createdAt",width:30,customRender:({record:e})=>P(e.createdAt)}],re=[{field:"fileType",label:a("fms.file.fileType"),colProps:{span:8},component:"Select",defaultValue:0,componentProps:{options:[{label:a("common.all"),value:0},{label:a("fms.file.other"),value:1},{label:a("fms.file.image"),value:2},{label:a("fms.file.video"),value:3},{label:a("fms.file.audio"),value:4}]}},{field:"fileName",label:a("fms.file.fileName"),defaultValue:"",component:"Input",colProps:{span:8}},{field:"tagIds",label:a("fms.tag.tag"),component:"ApiMultipleSelect",componentProps:{api:b,params:{page:1,pageSize:1e3,status:1},resultField:"data.data",labelField:"name",valueField:"id"},colProps:{span:8}},{field:"period",label:a("common.createTime"),component:"RangePicker",colProps:{span:8}}],K=[{field:"id",label:"ID",component:"Input",show:!1},{field:"name",label:a("fms.file.fileName"),required:!0,component:"Input"},{field:"tagIds",label:a("fms.tag.tag"),component:"ApiMultipleSelect",componentProps:{api:b,params:{page:1,pageSize:1e3,name:""},resultField:"data.data",labelField:"name",valueField:"id"}}],Q=x({name:"FileDrawer",components:{BasicDrawer:U,BasicForm:T},emits:["success","register"],setup(e,{emit:s}){const t=C(!0),{t:l}=z.useI18n(),[m,{resetFields:p,setFieldsValue:u,validate:o}]=B({labelWidth:160,baseColProps:{span:24},layout:"vertical",schemas:K,showActionButtonGroup:!1}),[i,{setDrawerProps:n,closeDrawer:M}]=G(r=>c(this,null,function*(){p(),n({confirmLoading:!1}),t.value=!!(r!=null&&r.isUpdate),F(t)&&u(h({},r.record))})),S=$(()=>F(t)?l("fms.file.editFile"):l("fms.file.addFile"));function _(){return c(this,null,function*(){try{const r=yield o();n({confirmLoading:!0}),yield q(r),M(),s("success")}finally{n({confirmLoading:!1})}})}return{registerDrawer:i,registerForm:m,getTitle:S,handleSubmit:_}}});function W(e,s,t,l,m,p){const u=w("BasicForm"),o=w("BasicDrawer");return A(),L(o,V(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"500px",onOk:e.handleSubmit}),{default:N(()=>[O(u,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const E=R(Q,[["render",W]]),fe=Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"}));export{E as F,le as a,fe as b,ne as c,oe as d,ie as g,re as s,ae as u};
