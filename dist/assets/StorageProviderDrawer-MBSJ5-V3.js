var D=Object.defineProperty;var g=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var v=(e,r,o)=>r in e?D(e,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[r]=o,h=(e,r)=>{for(var o in r||(r={}))C.call(r,o)&&v(e,o,r[o]);if(g)for(var o of g(r))B.call(r,o)&&v(e,o,r[o]);return e};var f=(e,r,o)=>new Promise((a,u)=>{var m=s=>{try{i(o.next(s))}catch(l){u(l)}},d=s=>{try{i(o.throw(s))}catch(l){u(l)}},i=s=>s.done?a(s.value):Promise.resolve(s.value).then(m,d);i((o=o.apply(e,r)).next())});import{_ as R,a as k}from"./useForm-Cq3McrEd.js";import{b as y,e as F,as as q,v as $,_ as T}from"./entry/index-DaEB-Y-8-1718870402071.js";import{u as p,c as M}from"./storageProvider-B3YMRov3.js";import{l as P,d as V,f as x,c as G,u as c,ab as b,_ as O,a7 as U,a8 as j,k as A,ac as L}from"./vue-BMCEF3Jf.js";import{Q as S}from"./antd-BNMfrwLX.js";import{B as H,a as K}from"./index-CL7BM-aX.js";const{t}=y(),re=[{title:t("fms.storageProvider.name"),dataIndex:"name",width:50},{title:t("fms.storageProvider.isDefault"),dataIndex:"isDefault",width:20,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),P(S,{checked:e.isDefault===!0,checkedChildren:t("common.yes"),unCheckedChildren:t("common.no"),loading:e.pendingStatus,onChange(r,o){e.pendingStatus=!0,p({id:e.id,isDefault:r}).then(()=>{e.isDefault=r,F()()}).finally(()=>{e.pendingStatus=!1})}}))},{title:t("common.status"),dataIndex:"state",width:20,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),P(S,{checked:e.state===!0,checkedChildren:t("common.on"),unCheckedChildren:t("common.off"),loading:e.pendingStatus,onChange(r,o){e.pendingStatus=!0;const a=!!r;p({id:e.id,state:a}).then(()=>{e.state=a}).finally(()=>{e.pendingStatus=!1})}}))},{title:t("common.createTime"),dataIndex:"createdAt",width:30,customRender:({record:e})=>q(e.createdAt)}],ae=[{field:"name",label:t("fms.storageProvider.name"),component:"Input",colProps:{span:8}}],N=[{field:"id",label:"ID",component:"Input",show:!1},{field:"name",label:t("fms.storageProvider.name"),component:"Input",required:!0,helpMessage:t("fms.storageProvider.nameHelpMessage")},{field:"bucket",label:t("fms.storageProvider.bucket"),component:"Input",required:!0},{field:"secretId",label:t("fms.storageProvider.secretId"),component:"Input",required:!0},{field:"secretKey",label:t("fms.storageProvider.secretKey"),component:"Input",required:!0},{field:"endpoint",label:t("fms.storageProvider.endpoint"),component:"Input",required:!0},{field:"folder",label:t("fms.storageProvider.folder"),component:"Input",helpMessage:t("fms.storageProvider.folderHelpMessage")},{field:"region",label:t("fms.storageProvider.region"),component:"Input",required:!0},{field:"useCdn",label:t("fms.storageProvider.useCdn"),component:"RadioButtonGroup",defaultValue:!1,componentProps:{options:[{label:t("common.on"),value:!0},{label:t("common.off"),value:!1}]},required:!0},{field:"cdnUrl",label:t("fms.storageProvider.cdnUrl"),component:"Input"},{field:"isDefault",label:t("fms.storageProvider.isDefault"),component:"RadioButtonGroup",defaultValue:!1,componentProps:{options:[{label:t("common.on"),value:!0},{label:t("common.off"),value:!1}]},required:!0},{field:"state",label:t("fms.storageProvider.state"),component:"RadioButtonGroup",defaultValue:!0,componentProps:{options:[{label:t("common.on"),value:!0},{label:t("common.off"),value:!1}]},required:!0}],z=V({name:"StorageProviderDrawer",components:{BasicDrawer:H,BasicForm:R},emits:["success","register"],setup(e,{emit:r}){const o=x(!0),{t:a}=$.useI18n(),[u,{resetFields:m,setFieldsValue:d,validate:i}]=k({labelWidth:110,baseColProps:{span:24},layout:"vertical",schemas:N,showActionButtonGroup:!1}),[s,{setDrawerProps:l,closeDrawer:w}]=K(n=>f(this,null,function*(){m(),l({confirmLoading:!1}),o.value=!!(n!=null&&n.isUpdate),c(o)&&d(h({},n.record))})),I=G(()=>c(o)?a("fms.storageProvider.editStorageProvider"):a("fms.storageProvider.addStorageProvider"));function _(){return f(this,null,function*(){const n=yield i();l({confirmLoading:!0}),n.id=c(o)?Number(n.id):0,(c(o)?yield p(n):yield M(n)).code===0&&(w(),r("success")),l({confirmLoading:!1})})}return{registerDrawer:s,registerForm:u,getTitle:I,handleSubmit:_}}});function Q(e,r,o,a,u,m){const d=b("BasicForm"),i=b("BasicDrawer");return O(),U(i,L(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"500px",onOk:e.handleSubmit}),{default:j(()=>[A(d,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const W=T(z,[["render",Q]]),se=Object.freeze(Object.defineProperty({__proto__:null,default:W},Symbol.toStringTag,{value:"Module"}));export{W as S,se as a,re as c,ae as s};
