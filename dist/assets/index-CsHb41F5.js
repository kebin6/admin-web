var u=(e,p,i)=>new Promise((m,d)=>{var f=n=>{try{o(i.next(n))}catch(l){d(l)}},h=n=>{try{o(i.throw(n))}catch(l){d(l)}},o=n=>n.done?m(n.value):Promise.resolve(n.value).then(f,h);o((i=i.apply(e,p)).next())});import{i as I}from"./index-DFMDnBcl.js";import{B as M,u as v}from"./useTable-CCLOgsii.js";import{T as L}from"./useForm-5wnZKxWU.js";import{aq as A,v as O,_ as P}from"./entry/index-C41ZFr6n-1718602026943.js";import W from"./RankTree-D3C6oR8b.js";import{u as $}from"./index-DDf_l8hU.js";import{M as E,g as F,c as N,s as V,d as T}from"./MemberDrawer-DHT4Fndq.js";import{P as U}from"./index-Dk0RLsSC.js";import{aX as j,aY as q,M as G}from"./antd-BPAr-OsJ.js";import{l as H}from"./token-CpVwqE1n.js";import{d as X,f as D,r as Y,k as s,ab as a,_ as y,a7 as k,a8 as r,G as S,a1 as B,aa as R}from"./vue-BMCEF3Jf.js";import"./ExclamationCircleOutlined-cpSGxMVL.js";import"./index-oRM4bmDd.js";import"./isBoolean-Dou3jA6I.js";import"./index-G5Wa8967.js";import"./useWindowSizeFn-Cczi9si3.js";import"./isDeepEqual-CCjWtLPA.js";import"./isNumber-j3SIk7av.js";import"./index-CrgunjrK.js";import"./object-BY_VTB7H.js";import"./onMountedOrActivated-CPthIpwg.js";import"./sortable.esm-DFFrMEeC.js";import"./index-D93fFNl6.js";import"./copyTextToClipboard-Cxs8Y4LI.js";import"./useSortable-B_A9JW_B.js";import"./index-CqgpaEX_.js";import"./index-9koevRY3.js";import"./memberRank-DAqz57a6.js";import"./cloudFile-B0Scyq7f.js";import"./useContentViewHeight-3hiKmHsM.js";const z=X({name:"MemberManagement",components:{BasicTable:M,MemberDrawer:E,TableAction:L,Button:A,PageWrapper:U,Row:j,Col:q,RankTree:W},setup(){const{t:e}=O.useI18n(),p=D(),i=Y({}),m=D(!1),[d,{openDrawer:f}]=$(),[h,{reload:o}]=v({title:e("sys.member.memberList"),api:F,columns:N,formConfig:{labelWidth:120,schemas:V},useSearchForm:!0,showTableSetting:!0,bordered:!0,showIndexColumn:!1,clickToRowSelect:!1,actionColumn:{width:30,title:e("common.action"),dataIndex:"action",fixed:void 0},rowKey:"id",rowSelection:{type:"checkbox",onChange:(t,c)=>{p.value=t,m.value=t.length>0}}});function n(){f(!0,{isUpdate:!1})}function l(t){f(!0,{record:t,isUpdate:!0})}function b(t){return u(this,null,function*(){(yield T({ids:[t.id]})).code===0&&(yield o())})}function g(){return u(this,null,function*(){G.confirm({title:e("common.deleteConfirm"),icon:s(I.ExclamationCircleOutlined),onOk(){return u(this,null,function*(){(yield T({ids:p.value})).code===0&&(m.value=!1,yield o())})},onCancel(){}})})}function w(t){return u(this,null,function*(){(yield H(t.id)).code===0&&(yield o())})}function C(){return u(this,null,function*(){yield o()})}function _(t){i.rankId=t,o()}return{t:e,registerTable:h,registerDrawer:d,handleCreate:n,handleEdit:l,handleDelete:b,handleSuccess:C,handleBatchDelete:g,handleSelect:_,handleLogout:w,showDeleteButton:m,searchInfo:i}}});function J(e,p,i,m,d,f){const h=a("RankTree"),o=a("Col"),n=a("Button"),l=a("a-button"),b=a("TableAction"),g=a("BasicTable"),w=a("Row"),C=a("MemberDrawer"),_=a("PageWrapper");return y(),k(_,{dense:"",contentFullHeight:""},{default:r(()=>[s(w,null,{default:r(()=>[s(o,{span:5},{default:r(()=>[s(h,{onSelect:e.handleSelect},null,8,["onSelect"])]),_:1}),s(o,{span:19},{default:r(()=>[s(g,{onRegister:e.registerTable,searchInfo:e.searchInfo},{tableTitle:r(()=>[e.showDeleteButton?(y(),k(n,{key:0,type:"primary",danger:"",preIcon:"ant-design:delete-outlined",onClick:e.handleBatchDelete},{default:r(()=>[S(B(e.t("common.delete")),1)]),_:1},8,["onClick"])):R("",!0)]),toolbar:r(()=>[s(l,{type:"primary",onClick:e.handleCreate},{default:r(()=>[S(B(e.t("sys.member.addMember")),1)]),_:1},8,["onClick"])]),bodyCell:r(({column:t,record:c})=>[t.key==="action"?(y(),k(b,{key:0,actions:[{icon:"clarity:note-edit-line",onClick:e.handleEdit.bind(null,c)},{icon:"bx:log-out-circle",color:"error",tooltip:e.t("sys.user.forceLoggingOut"),popConfirm:{title:e.t("sys.user.forceLoggingOut")+"?",placement:"left",confirm:e.handleLogout.bind(null,c)}},{icon:"ant-design:delete-outlined",color:"error",popConfirm:{title:e.t("common.deleteConfirm"),placement:"left",confirm:e.handleDelete.bind(null,c)}}]},null,8,["actions"])):R("",!0)]),_:1},8,["onRegister","searchInfo"])]),_:1})]),_:1}),s(C,{onRegister:e.registerDrawer,onSuccess:e.handleSuccess},null,8,["onRegister","onSuccess"])]),_:1})}const Re=P(z,[["render",J]]);export{Re as default};
