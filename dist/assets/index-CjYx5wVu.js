var m=(e,s,n)=>new Promise((i,l)=>{var d=t=>{try{r(n.next(t))}catch(a){l(a)}},c=t=>{try{r(n.throw(t))}catch(a){l(a)}},r=t=>t.done?i(t.value):Promise.resolve(t.value).then(d,c);r((n=n.apply(e,s)).next())});import{i as C}from"./index-DFMDnBcl.js";import{B as x,u as y}from"./useTable-CCLOgsii.js";import{T as _}from"./useForm-5wnZKxWU.js";import{b as B,as as h,aq as S,v as D,_ as v}from"./entry/index-C41ZFr6n-1718602026943.js";import{u as A,g as R,d as g}from"./token-Doj7c9RY.js";import{l as U,d as $,f as k,k as T,ab as u,_ as p,$ as P,a8 as f,a7 as w,G as M,a1 as N,aa as b}from"./vue-BMCEF3Jf.js";import{Q as V,M as E}from"./antd-BPAr-OsJ.js";import"./ExclamationCircleOutlined-cpSGxMVL.js";import"./index-oRM4bmDd.js";import"./isBoolean-Dou3jA6I.js";import"./index-G5Wa8967.js";import"./useWindowSizeFn-Cczi9si3.js";import"./isDeepEqual-CCjWtLPA.js";import"./isNumber-j3SIk7av.js";import"./index-CrgunjrK.js";import"./object-BY_VTB7H.js";import"./onMountedOrActivated-CPthIpwg.js";import"./sortable.esm-DFFrMEeC.js";import"./index-D93fFNl6.js";import"./copyTextToClipboard-Cxs8Y4LI.js";import"./useSortable-B_A9JW_B.js";import"./index-CqgpaEX_.js";import"./index-9koevRY3.js";const{t:o}=B(),F=[{title:"UUID",dataIndex:"id",width:80},{title:o("sys.login.username"),dataIndex:"username",width:50},{title:"Token",dataIndex:"token",width:50},{title:o("common.source"),dataIndex:"source",width:50},{title:o("common.status"),dataIndex:"status",width:40,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),U(V,{checked:e.status===1,checkedChildren:o("common.on"),unCheckedChildren:o("common.off"),loading:e.pendingStatus,onChange(s,n){e.pendingStatus=!0;const i=s?1:2;A({id:e.id,status:i}).then(()=>{e.status=i}).finally(()=>{e.pendingStatus=!1})}}))},{title:o("common.createTime"),dataIndex:"createdAt",width:50,customRender:({record:e})=>h(e.createdAt)},{title:o("common.expiredAt"),dataIndex:"expiredAt",width:50,customRender:({record:e})=>h(e.expiredAt)}],L=[{field:"UUID",label:"UUID",component:"Input",colProps:{span:8},rules:[{max:30}]},{field:"username",label:o("sys.login.username"),component:"Input",colProps:{span:8},rules:[{max:30}]},{field:"email",label:o("sys.login.email"),component:"Input",colProps:{span:8},rules:[{max:50}]},{field:"nickname",label:o("sys.user.nickname"),component:"Input",colProps:{span:8},rules:[{max:20}]}],O=$({name:"TokenManagement",components:{BasicTable:x,TableAction:_,Button:S},setup(){const{t:e}=D.useI18n(),s=k(),n=k(!1),[i,{reload:l}]=y({title:e("sys.token.tokenList"),api:R,columns:F,formConfig:{labelWidth:120,schemas:L},useSearchForm:!0,showTableSetting:!0,bordered:!0,showIndexColumn:!1,clickToRowSelect:!1,actionColumn:{width:30,title:e("common.action"),dataIndex:"action",fixed:void 0},rowKey:"id",rowSelection:{type:"checkbox",onChange:(t,a)=>{s.value=t,n.value=t.length>0}}});function d(t){return m(this,null,function*(){(yield g({ids:[t.id]})).code===0&&(yield l())})}function c(){return m(this,null,function*(){E.confirm({title:e("common.deleteConfirm"),icon:T(C.ExclamationCircleOutlined),onOk(){return m(this,null,function*(){(yield g({ids:s.value})).code===0&&(n.value=!1,yield l())})},onCancel(){}})})}function r(){return m(this,null,function*(){yield l()})}return{t:e,registerTable:i,handleDelete:d,handleSuccess:r,handleBatchDelete:c,showDeleteButton:n}}});function j(e,s,n,i,l,d){const c=u("Button"),r=u("TableAction"),t=u("BasicTable");return p(),P("div",null,[T(t,{onRegister:e.registerTable},{tableTitle:f(()=>[e.showDeleteButton?(p(),w(c,{key:0,type:"primary",danger:"",preIcon:"ant-design:delete-outlined",onClick:e.handleBatchDelete},{default:f(()=>[M(N(e.t("common.delete")),1)]),_:1},8,["onClick"])):b("",!0)]),bodyCell:f(({column:a,record:I})=>[a.key==="action"?(p(),w(r,{key:0,actions:[{icon:"ant-design:delete-outlined",color:"error",popConfirm:{title:e.t("common.deleteConfirm"),placement:"left",confirm:e.handleDelete.bind(null,I)}}]},null,8,["actions"])):b("",!0)]),_:1},8,["onRegister"])])}const pe=v(O,[["render",j]]);export{pe as default};
