var d=(e,t,a)=>new Promise((c,l)=>{var m=s=>{try{r(a.next(s))}catch(o){l(o)}},i=s=>{try{r(a.throw(s))}catch(o){l(o)}},r=s=>s.done?c(s.value):Promise.resolve(s.value).then(m,i);r((a=a.apply(e,t)).next())});import{a as y,b as M}from"./ExclamationCircleOutlined-BOht0FRf.js";import{b as _,as as h,a as B,aq as w,v as I,ar as C,_ as L}from"./entry/index-DaEB-Y-8-1718870402071.js";import{G as v,M as D}from"./antd-BNMfrwLX.js";import{l as R,d as O,f as k,r as S,k as g,ab as u,_ as b,a7 as T,a8 as p,G as x,a1 as A,aa as $,ac as V}from"./vue-BMCEF3Jf.js";import{B as F,a as N}from"./index-CmerSBcF.js";import{B as P,u as G}from"./useTable-DprHC9Xn.js";import"./useForm-Cq3McrEd.js";import"./index-DxzXX1s5.js";import"./useWindowSizeFn-NWtUJjFU.js";import"./isDeepEqual-BYVIA4i9.js";import"./isBoolean-Dou3jA6I.js";import"./isNumber-j3SIk7av.js";import"./index-BQ8_-9UH.js";import"./object-BY_VTB7H.js";import"./onMountedOrActivated-CPthIpwg.js";import"./sortable.esm-DFFrMEeC.js";import"./index-BgDhUzJz.js";import"./copyTextToClipboard-Ke6QqFB6.js";import"./useSortable-nsvvptnY.js";import"./index-BdOZjJKO.js";import"./index-D-g43U_h.js";const{t:n}=_(),H=[{title:n("sys.taskLog.startedAt"),dataIndex:"startedAt",width:50,customRender:({record:e})=>h(e.startedAt)},{title:n("sys.taskLog.finishedAt"),dataIndex:"finishedAt",width:50,customRender:({record:e})=>h(e.finishedAt)},{title:n("sys.taskLog.result"),dataIndex:"result",width:30,customRender:({record:e})=>{let t="";return e.result===1?t=n("common.successful"):t=n("common.failed"),R(v,{color:e.result===1?"green":"red"},t)}}],j=[{field:"result",label:n("sys.taskLog.result"),component:"Select",colProps:{span:8},defaultValue:0,componentProps:{options:[{label:n("common.all"),value:0},{label:n("common.successful"),value:1},{label:n("common.failed"),value:2}]}}],q=(e,t="notice")=>B.post({url:"/sys-api/task_log/list",params:e},{errorMessageMode:t}),E=(e,t="notice")=>B.post({url:"/sys-api/task_log/delete",params:e},{errorMessageMode:t,successMessageMode:t}),W=O({components:{BasicModal:F,BasicTable:P,DeleteOutlined:y,Button:w},setup(){const{t:e}=I.useI18n(),t=k(),a=k(!1),{notification:c}=C(),l=S({}),[m,{reload:i}]=G({title:e("sys.task.taskList"),api:q,columns:H,formConfig:{labelWidth:120,schemas:j},useSearchForm:!0,showTableSetting:!0,bordered:!0,showIndexColumn:!1,clickToRowSelect:!1,rowKey:"id",rowSelection:{type:"checkbox",onChange:(o,f)=>{t.value=o,a.value=o.length>0}}}),[r]=N(o=>d(this,null,function*(){l.taskId=o.record.id}));function s(){return d(this,null,function*(){D.confirm({title:e("common.deleteConfirm"),icon:g(M),onOk(){return d(this,null,function*(){const f=yield E({ids:t.value});f.code===0&&(a.value=!1,c.success({message:e("common.successful"),description:e(f.msg),duration:3}),yield i())})},onCancel(){}})})}return{t:e,registerTable:m,showDeleteButton:a,handleBatchDelete:s,registerModal:r,searchInfo:l}}});function z(e,t,a,c,l,m){const i=u("DeleteOutlined"),r=u("Button"),s=u("BasicTable"),o=u("BasicModal");return b(),T(o,V(e.$attrs,{title:e.t("sys.taskLog.taskLogList"),onRegister:e.registerModal,wrapperFooterOffset:50,cancelText:e.t("common.closeText"),showOkBtn:!1}),{default:p(()=>[g(s,{onRegister:e.registerTable,searchInfo:e.searchInfo,class:"tableHeight"},{tableTitle:p(()=>[e.showDeleteButton?(b(),T(r,{key:0,type:"primary",danger:"",onClick:e.handleBatchDelete},{icon:p(()=>[g(i)]),default:p(()=>[x(" "+A(e.t("common.delete")),1)]),_:1},8,["onClick"])):$("",!0)]),_:1},8,["onRegister","searchInfo"])]),_:1},16,["title","onRegister","cancelText"])}const ge=L(W,[["render",z]]);export{ge as default};
