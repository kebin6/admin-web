var x=Object.defineProperty;var k=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var g=(e,s,t)=>s in e?x(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,h=(e,s)=>{for(var t in s||(s={}))T.call(s,t)&&g(e,t,s[t]);if(k)for(var t of k(s))M.call(s,t)&&g(e,t,s[t]);return e};var f=(e,s,t)=>new Promise((r,u)=>{var p=o=>{try{i(t.next(o))}catch(l){u(l)}},c=o=>{try{i(t.throw(o))}catch(l){u(l)}},i=o=>o.done?r(o.value):Promise.resolve(o.value).then(p,c);i((t=t.apply(e,s)).next())});import{_ as D,a as S}from"./useForm-DGqLGoed.js";import{a as m,b as B,as as v,v as F,_ as C}from"./entry/index-DvPJ5Vzs-1718250502895.js";import{l as G,d as R,f as P,c as $,u as d,ab as w,_ as q,a7 as E,a8 as L,k as O,ac as j}from"./vue-BMCEF3Jf.js";import{Q as A}from"./antd-BPAr-OsJ.js";import{B as V,a as N}from"./index-BsqrLki-.js";const te=(e,s="notice")=>m.post({url:"/sys-api/task/list",params:e},{errorMessageMode:s}),U=(e,s="notice")=>m.post({url:"/sys-api/task/create",params:e},{errorMessageMode:s,successMessageMode:s}),y=(e,s="notice")=>m.post({url:"/sys-api/task/update",params:e},{errorMessageMode:s,successMessageMode:s}),ae=(e,s="notice")=>m.post({url:"/sys-api/task/delete",params:e},{errorMessageMode:s,successMessageMode:s}),{t:a}=B(),oe=[{title:a("sys.task.name"),dataIndex:"name",width:100},{title:a("sys.task.taskGroup"),dataIndex:"taskGroup",width:50},{title:a("sys.task.cronExpression"),dataIndex:"cronExpression",width:100},{title:a("sys.task.pattern"),dataIndex:"pattern",width:60},{title:a("common.status"),dataIndex:"status",width:40,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),G(A,{checked:e.status===1,checkedChildren:a("common.on"),unCheckedChildren:a("common.off"),loading:e.pendingStatus,onChange(s,t){e.pendingStatus=!0;const r=s?1:2;y({id:e.id,status:r}).then(()=>{e.status=r}).finally(()=>{e.pendingStatus=!1})}}))},{title:a("common.createTime"),dataIndex:"createdAt",width:50,customRender:({record:e})=>v(e.createdAt)}],ne=[{field:"name",label:a("sys.task.name"),component:"Input",colProps:{span:8},rules:[{max:50}]},{field:"taskGroup",label:a("sys.task.taskGroup"),component:"Input",colProps:{span:8},rules:[{max:40}]}],z=[{field:"id",label:"ID",component:"Input",show:!1},{field:"name",label:a("sys.task.name"),component:"Input",required:!0,rules:[{max:50}]},{field:"taskGroup",label:a("sys.task.taskGroup"),component:"Input",required:!0,rules:[{max:40}]},{field:"cronExpression",label:a("sys.task.cronExpression"),component:"Input",required:!0,rules:[{max:80}]},{field:"pattern",label:a("sys.task.pattern"),component:"Input",required:!0,rules:[{max:100}]},{field:"payload",label:a("sys.task.payload"),component:"Input",required:!0},{field:"status",label:a("sys.task.status"),component:"RadioButtonGroup",defaultValue:1,componentProps:{options:[{label:a("common.on"),value:1},{label:a("common.off"),value:2}]}}],H=R({name:"TaskDrawer",components:{BasicDrawer:V,BasicForm:D},emits:["success","register"],setup(e,{emit:s}){const t=P(!0),{t:r}=F.useI18n(),[u,{resetFields:p,setFieldsValue:c,validate:i}]=S({labelWidth:160,baseColProps:{span:24},layout:"vertical",schemas:z,showActionButtonGroup:!1}),[o,{setDrawerProps:l,closeDrawer:b}]=N(n=>f(this,null,function*(){p(),l({confirmLoading:!1}),t.value=!!(n!=null&&n.isUpdate),d(t)&&c(h({},n.record))})),_=$(()=>d(t)?r("sys.task.editTask"):r("sys.task.addTask"));function I(){return f(this,null,function*(){const n=yield i();l({confirmLoading:!0}),n.id=d(t)?Number(n.id):0,(d(t)?yield y(n):yield U(n)).code===0&&(b(),s("success")),l({confirmLoading:!1})})}return{registerDrawer:o,registerForm:u,getTitle:_,handleSubmit:I}}});function Q(e,s,t,r,u,p){const c=w("BasicForm"),i=w("BasicDrawer");return q(),E(i,j(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"500px",onOk:e.handleSubmit}),{default:L(()=>[O(c,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const W=C(H,[["render",Q]]),re=Object.freeze(Object.defineProperty({__proto__:null,default:W},Symbol.toStringTag,{value:"Module"}));export{W as T,re as a,oe as c,ae as d,te as g,ne as s};
