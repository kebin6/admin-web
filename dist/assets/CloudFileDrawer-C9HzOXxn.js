var C=Object.defineProperty;var c=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var g=(e,t,a)=>t in e?C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,F=(e,t)=>{for(var a in t||(t={}))P.call(t,a)&&g(e,a,t[a]);if(c)for(var a of c(t))T.call(t,a)&&g(e,a,t[a]);return e};var f=(e,t,a)=>new Promise((s,d)=>{var m=i=>{try{n(a.next(i))}catch(r){d(r)}},u=i=>{try{n(a.throw(i))}catch(r){d(r)}},n=i=>i.done?s(i.value):Promise.resolve(i.value).then(m,u);n((a=a.apply(e,t)).next())});import{_ as y,a as z}from"./useForm-Cq3McrEd.js";import{b as B,as as D,v as R,_ as k}from"./entry/index-DaEB-Y-8-1718870402071.js";import{a as h,c as x}from"./cloudFile-ULoT_c9i.js";import{g as v}from"./storageProvider-B3YMRov3.js";import{g as w}from"./cloudFileTag-D9WRDftu.js";import{l as A,d as $,f as q,c as L,u as p,ab as b,_ as M,a7 as O,a8 as V,k as j,ac as G}from"./vue-BMCEF3Jf.js";import{Q as N}from"./antd-BNMfrwLX.js";import{B as U,a as K}from"./index-CL7BM-aX.js";const{t:l}=B(),se=[{title:l("fms.cloudFile.name"),dataIndex:"name",width:50},{title:l("fms.cloudFile.size"),dataIndex:"size",width:30,customRender:({record:e})=>e.size>1073741824?(e.size/1073741824).toFixed(2)+"GB":e.size>1048576?(e.size/1048576).toFixed(2)+"MB":(e.size/1024).toFixed(2)+"KB"},{title:l("fms.cloudFile.fileType"),dataIndex:"fileType",width:20,customRender:({record:e})=>e.fileType===3?l("fms.file.video"):e.fileType===4?l("fms.file.audio"):e.fileType===2?l("fms.file.image"):l("fms.file.other")},{title:l("common.status"),dataIndex:"state",width:20,customRender:({record:e})=>(Reflect.has(e,"pendingStatus")||(e.pendingStatus=!1),A(N,{checked:e.state===!0,checkedChildren:l("common.on"),unCheckedChildren:l("common.off"),loading:e.pendingStatus,onChange(t,a){e.pendingStatus=!0;const s=!!t;h({id:e.id,state:s}).then(()=>{e.state=s}).finally(()=>{e.pendingStatus=!1})}}))},{title:l("common.createTime"),dataIndex:"createdAt",width:30,customRender:({record:e})=>D(e.createdAt)}],ne=[{field:"name",label:l("fms.cloudFile.name"),component:"Input",colProps:{span:8}},{field:"providerId",label:l("fms.cloudFile.providerId"),component:"ApiSelect",componentProps:{api:v,params:{page:1,pageSize:1e3},resultField:"data.data",labelField:"name",valueField:"id"},colProps:{span:8}},{field:"tagIds",label:l("fms.tag.tag"),component:"ApiMultipleSelect",componentProps:{api:w,params:{page:1,pageSize:1e3,name:""},resultField:"data.data",labelField:"name",valueField:"id"},colProps:{span:8}},{field:"fileType",label:l("fms.file.fileType"),colProps:{span:8},component:"Select",defaultValue:0,componentProps:{options:[{label:l("common.all"),value:0},{label:l("fms.file.other"),value:1},{label:l("fms.file.image"),value:2},{label:l("fms.file.video"),value:3},{label:l("fms.file.audio"),value:4}]}}],Q=[{field:"id",label:"ID",component:"Input",show:!1},{field:"name",label:l("fms.cloudFile.name"),component:"Input",required:!0},{field:"url",label:l("fms.cloudFile.url"),component:"Input",required:!0},{field:"size",label:l("fms.cloudFile.size"),component:"InputNumber",required:!0},{field:"fileType",label:l("fms.cloudFile.fileType"),component:"Select",required:!0,componentProps:{options:[{label:l("fms.file.other"),value:1},{label:l("fms.file.image"),value:2},{label:l("fms.file.video"),value:3},{label:l("fms.file.audio"),value:4}]}},{field:"userId",label:l("fms.cloudFile.userId"),component:"Input",required:!0},{field:"providerId",label:l("fms.cloudFile.providerId"),component:"ApiSelect",required:!0,componentProps:{api:v,params:{page:1,pageSize:1e3},resultField:"data.data",labelField:"name",valueField:"id"}},{field:"tagIds",label:l("fms.tag.tag"),component:"ApiMultipleSelect",componentProps:{api:w,params:{page:1,pageSize:1e3,name:""},resultField:"data.data",labelField:"name",valueField:"id"}},{field:"state",label:l("fms.cloudFile.state"),component:"RadioButtonGroup",defaultValue:!0,componentProps:{options:[{label:l("common.on"),value:!0},{label:l("common.off"),value:!1}]}}],W=$({name:"CloudFileDrawer",components:{BasicDrawer:U,BasicForm:y},emits:["success","register"],setup(e,{emit:t}){const a=q(!0),{t:s}=R.useI18n(),[d,{resetFields:m,setFieldsValue:u,validate:n}]=z({labelWidth:160,baseColProps:{span:24},layout:"vertical",schemas:Q,showActionButtonGroup:!1}),[i,{setDrawerProps:r,closeDrawer:I}]=K(o=>f(this,null,function*(){m(),r({confirmLoading:!1}),a.value=!!(o!=null&&o.isUpdate),p(a)&&u(F({},o.record))})),S=L(()=>p(a)?s("fms.cloudFile.editCloudFile"):s("fms.cloudFile.addCloudFile"));function _(){return f(this,null,function*(){const o=yield n();r({confirmLoading:!0}),o.id=p(a)?o.id:"",(p(a)?yield h(o):yield x(o)).code===0&&(I(),t("success")),r({confirmLoading:!1})})}return{registerDrawer:i,registerForm:d,getTitle:S,handleSubmit:_}}});function E(e,t,a,s,d,m){const u=b("BasicForm"),n=b("BasicDrawer");return M(),O(n,G(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"500px",onOk:e.handleSubmit}),{default:V(()=>[j(u,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const H=k(W,[["render",E]]),re=Object.freeze(Object.defineProperty({__proto__:null,default:H},Symbol.toStringTag,{value:"Module"}));export{H as C,re as a,se as c,ne as s};
