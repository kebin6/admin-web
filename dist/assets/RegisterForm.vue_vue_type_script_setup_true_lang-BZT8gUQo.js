var x=(T,i,d)=>new Promise((b,p)=>{var s=u=>{try{y(d.next(u))}catch(c){p(c)}},m=u=>{try{y(d.throw(u))}catch(c){p(c)}},y=u=>u.done?b(u.value):Promise.resolve(u.value).then(s,m);y((d=d.apply(T,i)).next())});import{d as L,f as C,r as q,c as R,u as e,_ as v,$ as E,k as l,a8 as n,a0 as N,G as g,a1 as f,a7 as k,aa as w,m as D,F as G,A}from"./vue-BMCEF3Jf.js";import{u as M,a as O,L as X,b as Y,c as Z}from"./LoginFormTitle-CzU2a9o1.js";import{S as $}from"./index-9koevRY3.js";import{b as j,aw as H,ax as J,ay as K}from"./entry/index-C41ZFr6n-1718602026943.js";import{a as Q,b as W,g as ee}from"./captcha-DWZvqVGS.js";import{C as ae}from"./index-D93fFNl6.js";import{U as S,i as h,O as se,Z as te,B,X as le,Y as re}from"./antd-BPAr-OsJ.js";const oe={class:"pt-4 pb-4"},fe=L({__name:"RegisterForm",setup(T){const i=S.Item,d=h.Password,b=le,p=re,{t:s}=j(),{handleBackLogin:m,getLoginState:y}=M(),u=C(),c=C(!1),a=q({msgType:"captcha",target:"",account:"",password:"",confirmPassword:"",email:"",captcha:"",captchaId:"",captchaVerified:"",imgPath:"",policy:!1}),{getFormRules:z}=O(a),{validForm:U}=Z(u),I=R(()=>a.msgType==="email"?s("sys.login.emailPlaceholder"):s("sys.login.mobilePlaceholder")),V=R(()=>e(y)===X.REGISTER);function _(){return x(this,null,function*(){const r=yield U();r&&(c.value=!0,a.msgType==="captcha"?(yield H({password:r.password,username:r.account,captcha:r.captcha,captchaId:r.captchaId,email:r.email})).code===0?(setTimeout(()=>{m()},2e3),c.value=!1):(P(),c.value=!1):a.msgType==="email"?((yield J({password:r.password,username:r.account,captcha:r.captchaVerified,email:r.target})).code===0&&setTimeout(()=>{m()},2e3),c.value=!1):((yield K({password:r.password,username:r.account,captcha:r.captchaVerified,phoneNumber:r.target})).code===0&&setTimeout(()=>{m()},2e3),c.value=!1))})}function F(){return x(this,null,function*(){return a.msgType=="email"?(yield Q({email:a.target})).code==0:(yield W({phoneNumber:a.target})).code==0})}function P(){return x(this,null,function*(){const r=yield ee("none").then();r.code===0&&(a.captchaId=r.data.captchaId,a.imgPath=r.data.imgPath)})}return P(),(r,t)=>V.value?(v(),E(G,{key:0},[l(Y,{class:"enter-x"}),l(e(S),{class:"p-4 enter-x",model:a,rules:e(z),ref_key:"formRef",ref:u},{default:n(()=>[N("div",oe,[l(e(b),{value:a.msgType,"onUpdate:value":t[0]||(t[0]=o=>a.msgType=o),"button-style":"solid",size:"large"},{default:n(()=>[l(e(p),{class:"bg-transparent",value:"captcha"},{default:n(()=>[g(f(e(s)("sys.login.captcha")),1)]),_:1}),l(e(p),{class:"bg-transparent",value:"email"},{default:n(()=>[g(f(e(s)("sys.login.email")),1)]),_:1}),l(e(p),{class:"bg-transparent",value:"sms"},{default:n(()=>[g(f(e(s)("sys.login.mobile")),1)]),_:1})]),_:1},8,["value"])]),l(e(i),{name:"account",class:"enter-x",rules:[{required:!0,message:e(s)("sys.login.accountPlaceholder")},{max:30,message:e(s)("sys.login.accountMaxLength")}]},{default:n(()=>[l(e(h),{class:"fix-auto-fill",size:"large",value:a.account,"onUpdate:value":t[1]||(t[1]=o=>a.account=o),placeholder:e(s)("sys.login.username")},null,8,["value","placeholder"])]),_:1},8,["rules"]),a.msgType==="captcha"?(v(),k(e(i),{key:0,name:"email",class:"enter-x"},{default:n(()=>[l(e(h),{size:"large",value:a.email,"onUpdate:value":t[2]||(t[2]=o=>a.email=o),placeholder:e(s)("sys.login.email"),rules:[{required:!0,type:"email"}],class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1})):w("",!0),l(e(i),{name:"password",class:"enter-x",rules:[{required:!0,message:e(s)("sys.login.passwordPlaceholder")},{min:6,max:30,message:e(s)("sys.login.passwordLength")}]},{default:n(()=>[l(e($),{size:"large",value:a.password,"onUpdate:value":t[3]||(t[3]=o=>a.password=o),placeholder:e(s)("sys.login.password")},null,8,["value","placeholder"])]),_:1},8,["rules"]),l(e(i),{name:"confirmPassword",class:"enter-x",rules:[{required:!0,message:e(s)("sys.login.passwordPlaceholder")},{min:6,max:30,message:e(s)("sys.login.passwordLength")}]},{default:n(()=>[l(e(d),{size:"large",visibilityToggle:"",value:a.confirmPassword,"onUpdate:value":t[4]||(t[4]=o=>a.confirmPassword=o),placeholder:e(s)("sys.login.confirmPassword")},null,8,["value","placeholder"])]),_:1},8,["rules"]),a.msgType!=="captcha"?(v(),k(e(i),{key:1,name:"target",class:"enter-x"},{default:n(()=>[l(e(h),{size:"large",value:a.target,"onUpdate:value":t[5]||(t[5]=o=>a.target=o),placeholder:I.value,"onUpdate:placeholder":t[6]||(t[6]=o=>I.value=o)},null,8,["value","placeholder"])]),_:1})):w("",!0),a.msgType!=="captcha"?(v(),k(e(i),{key:2,name:"captchaVerified",class:"enter-x"},{default:n(()=>[l(e(ae),{size:"large",value:a.captchaVerified,"onUpdate:value":t[7]||(t[7]=o=>a.captchaVerified=o),count:60,placeholder:e(s)("sys.login.captcha"),"send-code-api":F},null,8,["value","placeholder"])]),_:1})):w("",!0),a.msgType==="captcha"?(v(),k(e(i),{key:3,name:"captcha",class:"enter-x",rules:[{required:!0,len:5,message:e(s)("sys.login.captchaRequired")}]},{default:n(()=>[l(e(h),{size:"large",value:a.captcha,"onUpdate:value":t[8]||(t[8]=o=>a.captcha=o),placeholder:e(s)("sys.login.captcha"),class:"fix-auto-fill bg-transparent"},{suffix:n(()=>[l(e(se),{src:a.imgPath,width:120,height:40,preview:!1,onClick:P,class:"rounded"},null,8,["src"])]),_:1},8,["value","placeholder"])]),_:1},8,["rules"])):w("",!0),D(l(e(i),{name:"captchaId",class:"enter-x"},{default:n(()=>[l(e(h),{value:a.captchaId},null,8,["value"])]),_:1},512),[[A,!1]]),l(e(i),{class:"enter-x",name:"policy"},{default:n(()=>[l(e(te),{checked:a.policy,"onUpdate:checked":t[9]||(t[9]=o=>a.policy=o),class:"bg-transparent",size:"small"},{default:n(()=>[g(f(e(s)("sys.login.policy")),1)]),_:1},8,["checked"])]),_:1}),l(e(B),{type:"primary",class:"enter-x",size:"large",block:"",onClick:_,loading:c.value},{default:n(()=>[g(f(e(s)("sys.login.registerButton")),1)]),_:1},8,["loading"]),l(e(B),{size:"large",block:"",class:"mt-4 enter-x",onClick:e(m)},{default:n(()=>[g(f(e(s)("sys.login.backSignIn")),1)]),_:1},8,["onClick"])]),_:1},8,["model","rules"])],64)):w("",!0)}});export{fe as _};
