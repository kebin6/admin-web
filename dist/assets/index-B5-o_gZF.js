var b=(w,c,d)=>new Promise((u,r)=>{var f=m=>{try{i(d.next(m))}catch(v){r(v)}},t=m=>{try{i(d.throw(m))}catch(v){r(v)}},i=m=>m.done?u(m.value):Promise.resolve(m.value).then(f,t);i((d=d.apply(w,c)).next())});import{d as q,r as y,c as T,ab as g,_ as h,a7 as F,a8 as l,k as e,u as a,m as _,A as k,G as U,a1 as A}from"./vue-BMCEF3Jf.js";import{P as B}from"./index-va7oxFJT.js";import{v as D,c as N,bp as V,bq as $,br as j}from"./entry/index-DaEB-Y-8-1718870402071.js";import{h as G}from"./header-eUmriAJi.js";import{u as R}from"./cloudFile-ULoT_c9i.js";import{C as W}from"./index-BdOZjJKO.js";import{o as Z,U as z,aZ as E,d as x}from"./antd-BNMfrwLX.js";import"./useContentViewHeight-CtHro70F.js";import"./useWindowSizeFn-NWtUJjFU.js";import"./onMountedOrActivated-CPthIpwg.js";import"./isNumber-j3SIk7av.js";import"./index-CmerSBcF.js";import"./index-DxzXX1s5.js";import"./isDeepEqual-BYVIA4i9.js";const ra=q({__name:"index",setup(w){const c=Z,d=z,u=E,{t:r}=D.useI18n(),f=N(),t=y({avatar:"",nickname:"",email:"",mobile:""}),i=y({oldPassword:"",newPassword:""});function m(){return b(this,null,function*(){const s=yield V();s.code===0&&(t.nickname=s.data.nickname,t.email=s.data.email,t.mobile=s.data.mobile,t.avatar=s.data.avatar)})}m();function v(){return b(this,null,function*(){const s=yield $({avatar:t.avatar,nickname:t.nickname,email:t.email,mobile:t.mobile});s.code===0&&x.success(s.msg,3)})}function C(){return b(this,null,function*(){const s=yield j({oldPassword:i.oldPassword,newPassword:i.newPassword});s.code===0&&x.success(s.msg,3)})}function I(s){const o=f.getUserInfo;o.avatar=s,t.avatar=s,f.setUserInfo(o)}const S=T(()=>{const{avatar:s}=f.getUserInfo;return s||G});return(s,o)=>{const p=g("a-input"),P=g("a-button");return h(),F(a(B),null,{default:l(()=>[e(a(c),{title:a(r)("layout.header.profile"),style:{width:"100%"}},{default:l(()=>[e(a(d),{model:t,name:"basic","label-col":{span:8},"wrapper-col":{span:16},autocomplete:"off",onSubmit:o[4]||(o[4]=n=>v())},{default:l(()=>[e(a(u),{label:a(r)("sys.user.avatar")},{default:l(()=>[e(a(W),{uploadApi:a(R),value:S.value,btnText:a(r)("sys.user.changeAvatar"),btnProps:{preIcon:"ant-design:cloud-upload-outlined"},onChange:I,width:"150"},null,8,["uploadApi","value","btnText"])]),_:1},8,["label"]),_(e(a(u),{name:"avatar"},{default:l(()=>[_(e(p,{value:t.avatar,"onUpdate:value":o[0]||(o[0]=n=>t.avatar=n)},null,8,["value"]),[[k,!1]])]),_:1},512),[[k,!1]]),e(a(u),{label:a(r)("sys.user.nickname"),name:"nickname",rules:[{required:!0}]},{default:l(()=>[e(p,{value:t.nickname,"onUpdate:value":o[1]||(o[1]=n=>t.nickname=n)},null,8,["value"])]),_:1},8,["label"]),e(a(u),{label:a(r)("sys.login.mobile"),name:"mobile"},{default:l(()=>[e(p,{value:t.mobile,"onUpdate:value":o[2]||(o[2]=n=>t.mobile=n)},null,8,["value"])]),_:1},8,["label"]),e(a(u),{label:a(r)("sys.login.email"),name:"email",rules:[{required:!0}]},{default:l(()=>[e(p,{value:t.email,"onUpdate:value":o[3]||(o[3]=n=>t.email=n)},null,8,["value"])]),_:1},8,["label"]),e(a(u),{"wrapper-col":{offset:8,span:16}},{default:l(()=>[e(P,{type:"primary","html-type":"submit"},{default:l(()=>[U(A(a(r)("common.saveText")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"]),e(a(c),{title:a(r)("sys.user.changePassword"),style:{width:"100%"}},{default:l(()=>[e(a(d),{model:i,name:"basic","label-col":{span:8},"wrapper-col":{span:16},autocomplete:"off",onSubmit:o[7]||(o[7]=n=>C())},{default:l(()=>[e(a(u),{label:a(r)("sys.user.oldPassword"),name:"oldPassword",rules:[{required:!0}]},{default:l(()=>[e(p,{type:"password",value:i.oldPassword,"onUpdate:value":o[5]||(o[5]=n=>i.oldPassword=n)},null,8,["value"])]),_:1},8,["label"]),e(a(u),{label:a(r)("sys.user.newPassword"),name:"newPassword",rules:[{required:!0}]},{default:l(()=>[e(p,{type:"password",value:i.newPassword,"onUpdate:value":o[6]||(o[6]=n=>i.newPassword=n)},null,8,["value"])]),_:1},8,["label"]),e(a(u),{"wrapper-col":{offset:8,span:16}},{default:l(()=>[e(P,{type:"primary","html-type":"submit"},{default:l(()=>[U(A(a(r)("common.saveText")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]),_:1})}}});export{ra as default};
