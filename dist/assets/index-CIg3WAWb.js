var c=(e,u,s)=>new Promise((d,m)=>{var g=o=>{try{l(s.next(o))}catch(t){m(t)}},p=o=>{try{l(s.throw(o))}catch(t){m(t)}},l=o=>o.done?d(o.value):Promise.resolve(o.value).then(g,p);l((s=s.apply(e,u)).next())});import{i as L}from"./index-D46PiUjU.js";import{B as F,u as M}from"./useTable-DUDBe34E.js";import{T as W}from"./useForm-DGqLGoed.js";import O from"./DeptTree-C9HOyefE.js";import{u as P}from"./index-BsqrLki-.js";import{U as $,c as E,s as N}from"./UserDrawer-C_aKBz4C.js";import{aq as V,v as j,bv as q,bw as T,ar as z,_ as G}from"./entry/index-DvPJ5Vzs-1718250502895.js";import{W as H,d as X,f as k,r as Y,k as i,ab as a,_ as y,a7 as I,a8 as r,G as R,a1 as B,aa as v}from"./vue-BMCEF3Jf.js";import{g as J}from"./role-BPryK98z.js";import{l as K}from"./token-CFVpPawR.js";import{aX as Q,aY as Z,M as x}from"./antd-BPAr-OsJ.js";import{P as ee}from"./index-BhZXNDYX.js";import"./ExclamationCircleOutlined-s2Xy4hHc.js";import"./index-CU9epjG0.js";import"./isBoolean-Dou3jA6I.js";import"./index-3BhCtvAk.js";import"./useWindowSizeFn-DLNrSaDV.js";import"./isDeepEqual-DDA9_BTC.js";import"./isNumber-j3SIk7av.js";import"./index-Bji4O60f.js";import"./object-BY_VTB7H.js";import"./onMountedOrActivated-CPthIpwg.js";import"./sortable.esm-DFFrMEeC.js";import"./index-CBIPPzDl.js";import"./copyTextToClipboard-sKBLHCHY.js";import"./useSortable-DDWVM7pI.js";import"./index-DQkEJ5Ra.js";import"./index-DsLJPeYo.js";import"./department-BSfR8AAy.js";import"./position-3wTGBXMA.js";import"./cloudFile-JqJMo5Ni.js";import"./useContentViewHeight-Dm-gI_FW.js";const oe=H("app-role",{state:()=>({roleInfo:[]}),getters:{getRoleInfo(){return this.roleInfo}},actions:{getRoleInfoFromServer(){return c(this,null,function*(){const e=yield J({page:1,pageSize:1e3});this.roleInfo=e.data.data})}}}),te=X({name:"UserManagement",components:{BasicTable:F,UserDrawer:$,TableAction:W,PageWrapper:ee,Button:V,Row:Q,Col:Z,DeptTree:O},setup(){const{t:e}=j.useI18n(),{createMessage:u}=z(),s=k(),d=k(!1),m=Y({}),[g,{openDrawer:p}]=P();oe().getRoleInfoFromServer();const[o,{reload:t,getSelectRows:w}]=M({title:e("sys.user.userList"),api:q,columns:E,formConfig:{labelWidth:120,schemas:N},useSearchForm:!0,showTableSetting:!0,bordered:!0,showIndexColumn:!1,clickToRowSelect:!1,actionColumn:{width:30,title:e("common.action"),dataIndex:"action",fixed:void 0},rowKey:"id",rowSelection:{type:"checkbox",onChange:(n,h)=>{s.value=n,d.value=n.length>0}}});function b(){p(!0,{isUpdate:!1})}function C(n){p(!0,{record:n,isUpdate:!0})}function D(n){return c(this,null,function*(){if(n.nickname==="admin"){u.warn(e("common.notAllowDeleteAdminData"));return}(yield T({ids:[n.id]})).code===0&&(yield t())})}function S(){return c(this,null,function*(){x.confirm({title:e("common.deleteConfirm"),icon:i(L.ExclamationCircleOutlined),onOk(){return c(this,null,function*(){const h=s.value;if(w().filter(A=>A.nickname==="admin").length>0){u.warn(e("common.notAllowDeleteAdminData"));return}(yield T({ids:h})).code===0&&(yield t())})},onCancel(){}})})}function _(n){m.departmentId=n,t()}function f(n){return c(this,null,function*(){(yield K(n.id)).code===0&&(yield t())})}function U(){return c(this,null,function*(){yield t()})}return{t:e,registerTable:o,registerDrawer:g,handleCreate:b,handleEdit:C,handleLogout:f,handleDelete:D,handleSuccess:U,handleBatchDelete:S,handleSelect:_,showDeleteButton:d,searchInfo:m}}});function ne(e,u,s,d,m,g){const p=a("DeptTree"),l=a("Col"),o=a("Button"),t=a("a-button"),w=a("TableAction"),b=a("BasicTable"),C=a("Row"),D=a("UserDrawer"),S=a("PageWrapper");return y(),I(S,{dense:"",contentFullHeight:""},{default:r(()=>[i(C,null,{default:r(()=>[i(l,{span:5},{default:r(()=>[i(p,{onSelect:e.handleSelect},null,8,["onSelect"])]),_:1}),i(l,{span:19},{default:r(()=>[i(b,{onRegister:e.registerTable,searchInfo:e.searchInfo},{tableTitle:r(()=>[e.showDeleteButton?(y(),I(o,{key:0,type:"primary",danger:"",preIcon:"ant-design:delete-outlined",onClick:e.handleBatchDelete},{default:r(()=>[R(B(e.t("common.delete")),1)]),_:1},8,["onClick"])):v("",!0)]),toolbar:r(()=>[i(t,{type:"primary",onClick:e.handleCreate},{default:r(()=>[R(B(e.t("sys.user.addUser")),1)]),_:1},8,["onClick"])]),bodyCell:r(({column:_,record:f})=>[_.key==="action"?(y(),I(w,{key:0,actions:[{icon:"clarity:note-edit-line",onClick:e.handleEdit.bind(null,f)},{icon:"bx:log-out-circle",color:"error",tooltip:e.t("sys.user.forceLoggingOut"),popConfirm:{title:e.t("sys.user.forceLoggingOut")+"?",placement:"left",confirm:e.handleLogout.bind(null,f)}},{icon:"ant-design:delete-outlined",color:"error",popConfirm:{title:e.t("common.deleteConfirm"),placement:"left",confirm:e.handleDelete.bind(null,f)}}]},null,8,["actions"])):v("",!0)]),_:1},8,["onRegister","searchInfo"])]),_:1})]),_:1}),i(D,{onRegister:e.registerDrawer,onSuccess:e.handleSuccess},null,8,["onRegister","onSuccess"])]),_:1})}const Ee=G(te,[["render",ne]]);export{Ee as default};
